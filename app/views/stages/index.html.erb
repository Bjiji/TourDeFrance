<script>
    $(document).ready(function() {
        $('#stages').dataTable( {
            "sPaginationType": "full_numbers",
            "iDisplayLength": 50
        });
    } );
</script>
<h1>Les étapes</h1>
<div id="search">
  <%= render :partial => 'stages/search' %>
</div>
<table class="display" id="stages">
  <thead>
  <tr>
    <th>Année</th>
    <th>Etape</th>
    <th>Date</th>
    <th>Départ</th>
    <th>Arrivée</th>
    <th>Type</th>
    <th>Vainqueur</th>
    <th>Leader</th>
  </tr>
</thead>
<tbody>
<% @stages.each do |stage| %>
  <tr>
    <td><%= link_to stage.year, stage.race %></td>
    <td><%= link_to stage.stage_num, stage %></td>
    <td><%= link_to stage.date, stage %></td>
    <td><%= stage.start %></td>
    <td><%= stage.finish %></td>
    <td><%= stage.stage_type %></td>
    <td><%= if (stage.winner == nil) then '?' else link_to stage.winner.display_name, cyclist_path(stage.winner.id) end %></td>
    <td><%= if (stage.leader == nil) then '?' else link_to stage.leader.display_name, cyclist_path(stage.leader.id) end %></td>
  </tr>
<% end %>
</tbody>
</table>

<br />

<%= link_to 'New Stage', new_stage_path %>
